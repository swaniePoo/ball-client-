package me.dinozoid.strife.module.implementations.exploit;

import me.dinozoid.strife.Client;
import me.dinozoid.strife.alpine.listener.EventHandler;
import me.dinozoid.strife.alpine.listener.Listener;
import me.dinozoid.strife.event.implementations.player.PlayerMotionEvent;
import me.dinozoid.strife.module.Category;
import me.dinozoid.strife.module.Module;
import me.dinozoid.strife.module.ModuleInfo;
import me.dinozoid.strife.ui.notification.Notification;
import me.dinozoid.strife.util.network.ServerUtil;
import net.minecraft.entity.Entity;
import net.minecraft.entity.monster.*;
import net.minecraft.entity.passive.EntityPig;
import net.minecraft.entity.passive.EntitySheep;

@ModuleInfo(name = "EntityDesync", renderName = "EntityDesync", category = Category.EXPLOIT)
public class EntityDesyncModule extends Module {


    @EventHandler
    private final Listener<PlayerMotionEvent> updatePlayerListener = new Listener<>(event -> {
        if (ServerUtil.onServer("Hypixel")) {
            for (Entity target : mc.theWorld.loadedEntityList) {
                if (target instanceof EntityBlaze || target instanceof EntitySpider || target instanceof EntityCreeper || target instanceof EntityEnderman || target instanceof EntityZombie || target instanceof EntitySkeleton || target instanceof EntityGhast || target instanceof EntityPig || target instanceof EntitySheep) {
                    if (mc.thePlayer.ticksExisted % 15 == 0 && mc.thePlayer.getDistanceToEntity(target) < 6) {
                        mc.playerController.interactWithEntitySendPacket(mc.thePlayer, target);
                        Client.INSTANCE.getNotificationRepository().display(new Notification(Notification.NotificationType.SUCCESS, "EntityDesync", "You can fly now!", 1500));
                    }
                }
            }
        }
    });

}
